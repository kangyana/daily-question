import{_ as p,r as o,o as c,c as i,b as n,d as e,e as s,a as t}from"./app.2a439a8a.js";const l={},u=n("h1",{id:"\u3010q106\u3011webpack-\u4E2D\u7684-code-spliting-\u662F\u5982\u4F55\u52A8\u6001\u52A0\u8F7D-chunk-\u7684",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u3010q106\u3011webpack-\u4E2D\u7684-code-spliting-\u662F\u5982\u4F55\u52A8\u6001\u52A0\u8F7D-chunk-\u7684","aria-hidden":"true"},"#"),s(" \u3010Q106\u3011webpack \u4E2D\u7684 code spliting \u662F\u5982\u4F55\u52A8\u6001\u52A0\u8F7D chunk \u7684\uFF1F")],-1),r={class:"custom-container tip"},d=n("p",{class:"custom-container-title"},"Issue",-1),k=s("\u6B22\u8FCE\u5728 Gtihub Issue \u4E2D\u56DE\u7B54\u6B64\u95EE\u9898: "),m={href:"https://github.com/kangyana/daily-question/issues/106",target:"_blank",rel:"noopener noreferrer"},v=s("Issue 106"),_={class:"custom-container tip"},b=n("p",{class:"custom-container-title"},"Author",-1),h=s("\u56DE\u7B54\u8005: "),g={href:"https://github.com/kangyana",target:"_blank",rel:"noopener noreferrer"},y=s("kangyana"),f=t(`<h2 id="_1-\u4E00\u4E2A-webpack-\u7684\u8FD0\u884C\u65F6-\u5305\u62EC\u6700\u91CD\u8981\u7684\u4E24\u4E2A\u6570\u636E\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#_1-\u4E00\u4E2A-webpack-\u7684\u8FD0\u884C\u65F6-\u5305\u62EC\u6700\u91CD\u8981\u7684\u4E24\u4E2A\u6570\u636E\u7ED3\u6784" aria-hidden="true">#</a> 1. \u4E00\u4E2A webpack \u7684\u8FD0\u884C\u65F6\uFF0C\u5305\u62EC\u6700\u91CD\u8981\u7684\u4E24\u4E2A\u6570\u636E\u7ED3\u6784\uFF1A</h2><ul><li><strong><strong>webpack_modules</strong></strong>\uFF1A\u7EF4\u62A4\u4E00\u4E2A\u6240\u6709\u6A21\u5757\u7684\u6570\u7EC4\u3002 \u5C06\u5165\u53E3\u6A21\u5757\u89E3\u6790\u4E3A AST\uFF0C\u6839\u636E AST \u6DF1\u5EA6\u4F18\u5148\u641C\u7D22\u6240\u6709\u7684\u6A21\u5757\uFF0C\u5E76\u6784\u5EFA\u51FA\u8FD9\u4E2A\u6A21\u5757\u6570\u7EC4\u3002 \u6BCF\u4E2A\u6A21\u5757\u90FD\u7531\u4E00\u4E2A\u5305\u88F9\u51FD\u6570 (<code>module</code>, <code>module.exports</code>, <code>__webpack_require__</code>) \u5BF9\u6A21\u5757\u8FDB\u884C\u5305\u88F9\u6784\u6210\u3002</li><li><strong><strong>webpack_require</strong>(moduleId)</strong>\uFF1A\u624B\u52A8\u5B9E\u73B0\u52A0\u8F7D\u4E00\u4E2A\u6A21\u5757\u3002 \u5BF9\u5DF2\u52A0\u8F7D\u8FC7\u7684\u6A21\u5757\u8FDB\u884C\u7F13\u5B58\uFF0C\u5BF9\u672A\u52A0\u8F7D\u8FC7\u7684\u6A21\u5757\uFF0C\u6839\u636E id \u5B9A\u4F4D\u5230 <code>__webpack_modules__</code> \u4E2D\u7684\u5305\u88F9\u51FD\u6570\uFF0C\u6267\u884C\u5E76\u8FD4\u56DE <code>module.exports</code>\uFF0C\u5E76\u7F13\u5B58\u3002</li></ul><h2 id="_2-code-spliting" tabindex="-1"><a class="header-anchor" href="#_2-code-spliting" aria-hidden="true">#</a> 2. code spliting</h2><p>\u5728 webpack \u4E2D\uFF0C\u901A\u8FC7 <code>import()</code> \u53EF\u5B9E\u73B0 code spliting\u3002 \u5047\u8BBE\u6211\u4EEC\u6709\u4EE5\u4E0B\u6587\u4EF6\uFF1A</p><p><strong>index.js</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./sum&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  m<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>sum</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> sum<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,8),x=s("\u6211\u4EEC\u5C06\u4F7F\u7528\u4EE5\u4E0B\u7B80\u5355\u7684 webpack \u914D\u7F6E\u8FDB\u884C\u6253\u5305\uFF0C\u5177\u4F53\u793A\u4F8B\u53EF\u53C2\u8003 "),w={href:"https://github.com/shfshanyue/node-examples/blob/master/engineering/webpack/code-spliting/build.js",target:"_blank",rel:"noopener noreferrer"},j=s("node-examples:code-spliting(opens new window)"),q=t(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./index.js&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].[contenthash].js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&#39;chunk.[name].[id].[contenthash].js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist/deterministic&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">moduleIds</span><span class="token operator">:</span> <span class="token string">&#39;deterministic&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">chunkIds</span><span class="token operator">:</span> <span class="token string">&#39;deterministic&#39;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-\u8FD0\u884C\u65F6\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#_3-\u8FD0\u884C\u65F6\u89E3\u6790" aria-hidden="true">#</a> 3. \u8FD0\u884C\u65F6\u89E3\u6790</h2><p>\u901A\u8FC7\u89C2\u5BDF\u6253\u5305\u540E\u7684\u6587\u4EF6 <code>dist/deterministic/main.xxxxxx.js</code>\uFF0C\u53EF\u4EE5\u53D1\u73B0\uFF1A \u4F7F\u7528 <code>import()</code> \u52A0\u8F7D\u6570\u636E\u65F6\uFF0C\u4EE5\u4E0A\u4EE3\u7801\u5C06\u88AB webpack \u7F16\u8BD1\u4E3A\u4EE5\u4E0B\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>__webpack_require__
  <span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token comment">/* import() | sum */</span> <span class="token number">644</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token function">__webpack_require__</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>__webpack_require__<span class="token punctuation">,</span> <span class="token number">709</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    m<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6B64\u65F6 <code>644</code> \u4E3A chunkId\uFF0C\u89C2\u5BDF <code>chunk.sum.xxxx.js</code> \u6587\u4EF6\uFF0C\u4EE5\u4E0B\u4E3A <code>sum</code> \u51FD\u6570\u6240\u6784\u5EFA\u800C\u6210\u7684 chunk\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>self<span class="token punctuation">[</span><span class="token string">&quot;webpackChunk&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">[</span><span class="token string">&quot;webpackChunk&quot;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">644</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/***/ 709: /***/</span> <span class="token punctuation">(</span>
      <span class="token parameter">__unused_webpack_module<span class="token punctuation">,</span>
      __webpack_exports__<span class="token punctuation">,</span>
      __webpack_require__</span>
    <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      __webpack_require__<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">/* harmony export */</span> __webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token comment">/* harmony export */</span> <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> __WEBPACK_DEFAULT_EXPORT__<span class="token punctuation">,</span>
        <span class="token comment">/* harmony export */</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token function-variable function">sum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>

      <span class="token comment">/* harmony default export */</span> <span class="token keyword">const</span> __WEBPACK_DEFAULT_EXPORT__ <span class="token operator">=</span> sum<span class="token punctuation">;</span>

      <span class="token doc-comment comment">/***/
    <span class="token punctuation">}</span>,
  <span class="token punctuation">}</span>,
]);
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0B\u4E24\u4E2A\u6570\u636E\u7ED3\u6784\u662F\u52A0\u8F7D chunk \u7684\u5173\u952E:</p><ul><li><strong><strong>webpack_require</strong>.e</strong>\uFF1A\u52A0\u8F7D chunk\u3002 \u8BE5\u51FD\u6570\u5C06\u4F7F\u7528 <code>document.createElement(&#39;script&#39;)</code> \u5F02\u6B65\u52A0\u8F7D chunk \u5E76\u5C01\u88C5\u4E3A Promise\u3002</li><li><strong>self[&quot;webpackChunk&quot;].push</strong>\uFF1AJSONP cllaback\u3002 \u6536\u96C6 modules \u81F3 <code>__webpack_modules__</code>\uFF0C\u5E76\u5C06 <code>__webpack_require__.e</code> \u7684 Promise \u8FDB\u884C resolve\u3002</li></ul><p>\u5B9E\u9645\u4E0A\uFF0C\u5728 webpack \u4E2D\u53EF\u914D\u7F6E <code>output.chunkLoading</code> \u6765\u9009\u62E9\u52A0\u8F7D chunk \u7684\u65B9\u5F0F\uFF0C\u6BD4\u5982\u9009\u62E9\u901A\u8FC7 <code>import() </code>\u7684\u65B9\u5F0F\u8FDB\u884C\u52A0\u8F7D\u3002 (\u7531\u4E8E\u5728\u751F\u4EA7\u73AF\u5883\u9700\u8981\u8003\u8651 <code>import</code> \u7684\u517C\u5BB9\u6027\uFF0C\u76EE\u524D\u8FD8\u662F JSONP \u65B9\u5F0F\u8F83\u591A)</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./index.js&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;main.[contenthash].js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&#39;[name].chunk.[chunkhash].js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist/import&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// \u9ED8\u8BA4\u4E3A \`jsonp\`</span>
    <span class="token literal-property property">chunkLoading</span><span class="token operator">:</span> <span class="token string">&#39;import&#39;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10),E=s("\u53EF\u53C2\u8003\u793A\u4F8B "),I={href:"https://github.com/shfshanyue/node-examples/blob/master/engineering/webpack/code-spliting/example/runtime.js",target:"_blank",rel:"noopener noreferrer"},P=s("webpack \u8FD0\u884C\u65F6\u4EE3\u7801 (opens new window)"),A=s("\u4E2D\u67E5\u770B\u52A0\u8F7D\u4E00\u4E2A chunk \u7684\u5B9E\u73B0\u3002");function T(C,L){const a=o("ExternalLinkIcon");return c(),i("div",null,[u,n("div",r,[d,n("p",null,[k,n("a",m,[v,e(a)])])]),n("div",_,[b,n("p",null,[h,n("a",g,[y,e(a)])])]),f,n("p",null,[x,n("a",w,[j,e(a)])]),q,n("p",null,[E,n("a",I,[P,e(a)]),A])])}const B=p(l,[["render",T],["__file","106.html.vue"]]);export{B as default};
