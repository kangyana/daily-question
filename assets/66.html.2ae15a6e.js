import{_ as p,r as o,o as c,c as l,b as n,d as t,e as s,a as e}from"./app.2a439a8a.js";const i={},u=n("h1",{id:"\u3010q066\u3011\u53D7\u63A7\u7EC4\u4EF6\u548C\u975E\u53D7\u63A7\u7EC4\u4EF6",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u3010q066\u3011\u53D7\u63A7\u7EC4\u4EF6\u548C\u975E\u53D7\u63A7\u7EC4\u4EF6","aria-hidden":"true"},"#"),s(" \u3010Q066\u3011\u53D7\u63A7\u7EC4\u4EF6\u548C\u975E\u53D7\u63A7\u7EC4\u4EF6")],-1),r={class:"custom-container tip"},d=n("p",{class:"custom-container-title"},"Issue",-1),k=s("\u6B22\u8FCE\u5728 Gtihub Issue \u4E2D\u56DE\u7B54\u6B64\u95EE\u9898: "),v={href:"https://github.com/kangyana/daily-question/issues/66",target:"_blank",rel:"noopener noreferrer"},m=s("Issue 66"),h={class:"custom-container tip"},b=n("p",{class:"custom-container-title"},"Author",-1),g=s("\u56DE\u7B54\u8005: "),f={href:"https://github.com/kangyana",target:"_blank",rel:"noopener noreferrer"},_=s("kangyana"),y=e(`<h2 id="_1-\u53D7\u63A7\u7EC4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_1-\u53D7\u63A7\u7EC4\u4EF6" aria-hidden="true">#</a> 1. \u53D7\u63A7\u7EC4\u4EF6</h2><p>\u884C\u4E3A\u53D7 React <strong>\u72B6\u6001</strong>(state) \u63A7\u5236\u7684\u8868\u5355\u7EC4\u4EF6\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">Input</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> onChange <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token function">onChange</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-\u975E\u53D7\u63A7\u7EC4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_2-\u975E\u53D7\u63A7\u7EC4\u4EF6" aria-hidden="true">#</a> 2. \u975E\u53D7\u63A7\u7EC4\u4EF6</h2><p>\u884C\u4E3A\u4E0D\u53D7 React <strong>\u72B6\u6001</strong> \u63A7\u5236\u7684\u8868\u5355\u7EC4\u4EF6\uFF0C\u884C\u4E3A\u5B8C\u5168\u7531\u7528\u6237\u64CD\u4F5C\u5F71\u54CD\u3002</p><div class="language-javacscript ext-javacscript line-numbers-mode"><pre class="language-javacscript"><code>const Input = () =&gt; {
  const [value, setValue] = useState(&#39;&#39;);
  
  return &lt;input value={value} onChange={e =&gt; setValue(e.target.value)} /&gt;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-\u53D7\u63A7\u7EC4\u4EF6-\u548C-\u975E\u53D7\u63A7\u7EC4\u4EF6-\u7684\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#_3-\u53D7\u63A7\u7EC4\u4EF6-\u548C-\u975E\u53D7\u63A7\u7EC4\u4EF6-\u7684\u533A\u522B" aria-hidden="true">#</a> 3. \u53D7\u63A7\u7EC4\u4EF6 \u548C \u975E\u53D7\u63A7\u7EC4\u4EF6 \u7684\u533A\u522B</h2><p>\u63A7\u5236\u7EC4\u4EF6\u884C\u4E3A\u7684 <strong>\u72B6\u6001</strong> \u662F\u5426\u7531\u5916\u90E8\u4F20\u5165\u3002</p><p><img src="https://pic4.zhimg.com/80/v2-7285ea005390e41d3245b960af384d73_720w.jpg" alt="alt"> \u56FE\u4E2D\u84DD\u8272\u8868\u793A <strong>\u7EC4\u4EF6</strong>\uFF0C\u9EC4\u8272\u8868\u793A <strong>\u72B6\u6001</strong>\u3002</p><h2 id="_4-\u53D7\u63A7\u53C8\u975E\u53D7\u63A7\u7EC4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_4-\u53D7\u63A7\u53C8\u975E\u53D7\u63A7\u7EC4\u4EF6" aria-hidden="true">#</a> 4. \u53D7\u63A7\u53C8\u975E\u53D7\u63A7\u7EC4\u4EF6</h2><p>\u73B0\u4EE3\u7EC4\u4EF6\u5E93\uFF0C\u6709\u975E\u5E38\u591A\u7684\u7EC4\u4EF6\u9700\u8981\u505A\u5230\u65E2\u652F\u6301\u53D7\u63A7\u6A21\u5F0F\uFF0C\u53C8\u652F\u6301\u975E\u53D7\u63A7\u6A21\u5F0F\u3002 \u4F8B\u5982 <code>antd</code> \u6D89\u53CA <strong>\u8F93\u5165\u503C\u3001\u5207\u6362\u3001\u5C55\u5F00\u6536\u8D77</strong> \u7684\u7EC4\u4EF6\uFF0C\u90FD\u9700\u8981\u505A\u5230\u3002</p>`,11),w={class:"custom-container tip"},C=n("p",{class:"custom-container-title"},"Author",-1),x=s("\u56DE\u7B54\u8005: "),j={href:"https://github.com/kangyana",target:"_blank",rel:"noopener noreferrer"},R=s("kangyana"),V=e(`<h2 id="_5-\u5982\u4F55\u5B9E\u73B0-\u53D7\u63A7\u53C8\u975E\u53D7\u63A7\u7EC4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_5-\u5982\u4F55\u5B9E\u73B0-\u53D7\u63A7\u53C8\u975E\u53D7\u63A7\u7EC4\u4EF6" aria-hidden="true">#</a> 5. \u5982\u4F55\u5B9E\u73B0 \u53D7\u63A7\u53C8\u975E\u53D7\u63A7\u7EC4\u4EF6</h2><h3 id="\u89E3\u51B3\u65B9\u6848-\u5185\u5916\u4E24\u4E2A\u72B6\u6001-\u624B\u52A8\u540C\u6B65" tabindex="-1"><a class="header-anchor" href="#\u89E3\u51B3\u65B9\u6848-\u5185\u5916\u4E24\u4E2A\u72B6\u6001-\u624B\u52A8\u540C\u6B65" aria-hidden="true">#</a> \u89E3\u51B3\u65B9\u6848\uFF1A\u5185\u5916\u4E24\u4E2A\u72B6\u6001\uFF0C\u624B\u52A8\u540C\u6B65</h3><p>\u65E0\u8BBA\u54EA\u79CD\u6A21\u5F0F\u90FD\u4F7F\u7528 <strong>\u5B50\u7EC4\u4EF6\u72B6\u6001</strong> \u3002 \u5F53 <strong>\u53D7\u63A7\u6A21\u5F0F</strong> \u65F6\uFF0C\u5C06 <strong>\u7236\u7EC4\u4EF6\u72B6\u6001</strong> \u540C\u6B65\u7ED9 <strong>\u5B50\u7EC4\u4EF6\u72B6\u6001</strong>\u3002 <img src="https://pic1.zhimg.com/v2-1334f4d825c82890005508729e6ff6cc_r.jpg" alt="alt"></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">Input</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> _value<span class="token punctuation">,</span> onChange <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">const</span> isControlled <span class="token operator">=</span>_value <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// \u662F\u5426\u53D7\u63A7</span>
  
  <span class="token keyword">const</span> <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u4E0D\u53D7\u63A7\u624D\u6539\u53D8\u5185\u90E8\u72B6\u6001</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isControlled<span class="token punctuation">)</span> <span class="token function">setValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onChange</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u5916\u90E8\u503C\u53D8\u5316\uFF0C\u624B\u52A8\u540C\u6B65\u5185\u90E8\u72B6\u6001</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isControlled<span class="token punctuation">)</span> <span class="token function">setValue</span><span class="token punctuation">(</span>_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>isControlled<span class="token punctuation">]</span><span class="token punctuation">)</span>
  
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4ED4\u7EC6\u770B\u4E0A\u9762\u7684\u4EE3\u7801\uFF0C\u6211\u4EEC\u4F1A\u53D1\u73B0\u5728 <strong>\u53D7\u63A7\u6A21\u5F0F</strong> \u4E0B\u5B58\u5728\u4E24\u4E2A\u95EE\u9898\uFF1A</p><ul><li>\u539F\u5B50\u6027\uFF1A<strong>\u5B50\u7EC4\u4EF6\u72B6\u6001</strong> \u66F4\u65B0\u6BD4 <strong>\u7236\u7EC4\u4EF6\u72B6\u6001</strong> \u66F4\u65B0\u665A\u4E00\u4E2A\u6E32\u67D3\u5468\u671F\u3002\u4EA7\u751F\u6495\u88C2\u611F\uFF08tearing\uFF09\u3002</li><li>\u6027\u80FD\uFF1A\u5728 <code>useEffect</code> \u4F7F\u7528 <code>setState</code>\uFF0C\u4F1A\u989D\u5916\u89E6\u53D1\u4E00\u6B21\u6E32\u67D3\u3002</li></ul>`,6),I={class:"custom-container tip"},S=n("p",{class:"custom-container-title"},"Author",-1),E=s("\u56DE\u7B54\u8005: "),U={href:"https://github.com/kangyana",target:"_blank",rel:"noopener noreferrer"},z=s("kangyana"),A=e(`<h2 id="_6-\u89E3\u51B3\u539F\u5B50\u6027" tabindex="-1"><a class="header-anchor" href="#_6-\u89E3\u51B3\u539F\u5B50\u6027" aria-hidden="true">#</a> 6. \u89E3\u51B3\u539F\u5B50\u6027</h2><p>\u6211\u4EEC\u4E0D\u9700\u8981 <strong>\u5B50\u7EC4\u4EF6\u72B6\u6001</strong> \u548C <strong>\u7236\u7EC4\u4EF6\u72B6\u6001</strong> \u65F6\u523B\u7EDF\u4E00\u3002 \u53EA\u9700\u8981\u5224\u65AD\uFF0C<strong>\u53D7\u63A7\u6A21\u5F0F</strong> \u4E0B\u76F4\u63A5\u4F7F\u7528 <strong>\u7236\u7EC4\u4EF6\u72B6\u6001</strong> \u5C31\u597D\u4E86\u3002</p><p><img src="https://pic2.zhimg.com/80/v2-c2148d954e3f4a85150928cc4a076bbd_720w.webp" alt="alt"></p><p>\u8FD9\u6837\u5373\u4F7F\u72B6\u6001\u7684\u540C\u6B65\u5B58\u5728\u5EF6\u8FDF\uFF0C\u5B50\u7EC4\u4EF6\u4F7F\u7528\u7684\u503C\u4E5F\u662F\u6700\u65B0\u7684\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">Input</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...\u540C\u4E0A\u9762\u7684</span>
  <span class="token keyword">const</span> finalValue <span class="token operator">=</span> isControlled <span class="token operator">?</span> _value <span class="token operator">:</span> value<span class="token punctuation">;</span> <span class="token comment">// \u771F\u6B63\u4F7F\u7528\u7684\u503C</span>
  
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>finalValue<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-\u89E3\u51B3\u6027\u80FD" tabindex="-1"><a class="header-anchor" href="#_7-\u89E3\u51B3\u6027\u80FD" aria-hidden="true">#</a> 7. \u89E3\u51B3\u6027\u80FD</h2><p>\u5728 <code>useEffect</code> \u4F7F\u7528 <code>setState</code>\uFF0C\u4F1A\u989D\u5916\u89E6\u53D1\u4E00\u6B21 <strong>\u5B50\u7EC4\u4EF6</strong> \u7684\u6E32\u67D3\u3002</p><h3 id="\u6B64\u5904-state-\u7684\u4F5C\u7528\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#\u6B64\u5904-state-\u7684\u4F5C\u7528\u662F\u4EC0\u4E48" aria-hidden="true">#</a> \u6B64\u5904 <code>state</code> \u7684\u4F5C\u7528\u662F\u4EC0\u4E48\uFF1F</h3><ul><li>\u6301\u4E45\u5316\u5B58\u653E\u6570\u636E</li><li>\u66F4\u65B0\u4F1A\u89E6\u53D1\u91CD\u6E32\u67D3</li></ul><h3 id="\u662F\u5426\u80FD\u7ED5\u8FC7-state-\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#\u662F\u5426\u80FD\u7ED5\u8FC7-state-\u673A\u5236" aria-hidden="true">#</a> \u662F\u5426\u80FD\u7ED5\u8FC7 <code>state</code> \u673A\u5236?</h3><p>\u53EF\u4EE5\u4F7F\u7528 <code>ref</code> + <code>forceUpdate</code> \u7684\u7EC4\u5408\u3002</p><p><img src="https://pic2.zhimg.com/80/v2-fea0d9c628e4c7fc70fc5b4eb6249e39_720w.webp" alt="alt"> \u56FE\u4E2D\u7684\u865A\u7EBF\u6D45\u8272\u5706\u5708\u8868\u793A <code>ref</code>\uFF0C\u5237\u65B0\u56FE\u6807\u8868\u793A <code>forceUpdate</code> \u51FD\u6570\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">Input</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> _value<span class="token punctuation">,</span> onChange <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  
  <span class="token keyword">const</span> <span class="token punctuation">[</span>flag<span class="token punctuation">,</span> forceUpdate<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u89E6\u53D1\u6E32\u67D3\u7528\u7684</span>
  
  <span class="token keyword">const</span> isControlled <span class="token operator">=</span>_value <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// \u662F\u5426\u53D7\u63A7</span>
  
  <span class="token keyword">const</span> stateRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span>_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// \u53D7\u63A7\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u5916\u90E8\u7684\u503C\u540C\u6B65\u7ED9 Ref</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isControlled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stateRef<span class="token punctuation">.</span>current <span class="token operator">=</span> _value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">const</span> <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u624B\u52A8\u540C\u6B65 Ref</span>
    stateRef<span class="token punctuation">.</span>current <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token comment">// \u624B\u52A8\u89E6\u53D1\u6E32\u67D3</span>
    <span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onChange</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span>stateRef<span class="token punctuation">.</span>current<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13),N={class:"custom-container tip"},q=n("p",{class:"custom-container-title"},"Author",-1),B=s("\u56DE\u7B54\u8005: "),L={href:"https://github.com/kangyana",target:"_blank",rel:"noopener noreferrer"},G=s("kangyana"),H=e(`<h2 id="_7-\u62BD\u8C61\u4E0E\u590D\u7528" tabindex="-1"><a class="header-anchor" href="#_7-\u62BD\u8C61\u4E0E\u590D\u7528" aria-hidden="true">#</a> 7. \u62BD\u8C61\u4E0E\u590D\u7528</h2><p>\u6211\u4EEC\u53EF\u4EE5\u628A <code>\u53D7\u63A7\u53C8\u975E\u53D7\u63A7\u7EC4\u4EF6</code> \u7684\u6548\u679C\u5C01\u88C5\u4E3A <code>Hook</code>\uFF0C\u4F9B\u5176\u4ED6\u8868\u5355\u7EC4\u4EF6\u4F7F\u7528\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">usePropsValue</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> onChange<span class="token punctuation">,</span> defaultValue <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
    
  <span class="token keyword">const</span> <span class="token punctuation">[</span>flag<span class="token punctuation">,</span> forceUpdate<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u89E6\u53D1\u6E32\u67D3\u7528\u7684</span>
  
  <span class="token keyword">const</span> isControlled <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> value <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>value<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u662F\u5426\u53D7\u63A7</span>
  
  <span class="token keyword">const</span> stateRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span>isControlled <span class="token operator">?</span> value <span class="token operator">:</span> defaultValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// \u53D7\u63A7\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u5916\u90E8\u7684\u503C\u540C\u6B65\u7ED9 Ref</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isControlled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stateRef<span class="token punctuation">.</span>current <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token function-variable function">setState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">nextValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextValue <span class="token operator">===</span> stateRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token comment">// \u624B\u52A8\u540C\u6B65 Ref</span>
    stateRef<span class="token punctuation">.</span>current <span class="token operator">=</span> nextValue<span class="token punctuation">;</span>
    <span class="token comment">// \u624B\u52A8\u89E6\u53D1\u6E32\u67D3</span>
    <span class="token function">forceUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    onChange<span class="token operator">?.</span><span class="token punctuation">(</span>nextValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">return</span> <span class="token punctuation">[</span>stateRef<span class="token punctuation">.</span>current<span class="token punctuation">,</span> setState<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3);function M(P,Q){const a=o("ExternalLinkIcon");return c(),l("div",null,[u,n("div",r,[d,n("p",null,[k,n("a",v,[m,t(a)])])]),n("div",h,[b,n("p",null,[g,n("a",f,[_,t(a)])])]),y,n("div",w,[C,n("p",null,[x,n("a",j,[R,t(a)])])]),V,n("div",I,[S,n("p",null,[E,n("a",U,[z,t(a)])])]),A,n("div",N,[q,n("p",null,[B,n("a",L,[G,t(a)])])]),H])}const D=p(i,[["render",M],["__file","66.html.vue"]]);export{D as default};
